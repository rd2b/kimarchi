bundle agent app_dns {
vars:
    any::
    "dnsdir" string => "$(globals.group_path)/groups/dns/";

    dns::
        "dnsfilestocopy" slist => { 
            "/etc/bind/acgform.local", 
            "/etc/bind/named.conf.local" };

    acgform_local.!dns::
        "resolvconf" string => "$(dnsdir)/etc/acgform-resolv.conf";


files:
    dns::
        "$(dnsfilestocopy)"
        comment   => "copy $(dnsfilestocopy) to /etc",
        perms     => promisemode("644"),
        copy_from => secure_cp("$(dnsdir)/$(dnsfilestocopy)","$(globals.serverhost)");

    acgform_local.!dns:: 
        "/etc/resolv.conf"
        comment   => "copying /etc/resolv.conf for acgform",
        perms     => promisemode("644"),
        copy_from => secure_cp("$(resolvconf)","$(globals.serverhost)");


reports:
    dns::
        "I am a DNS Master";
}

